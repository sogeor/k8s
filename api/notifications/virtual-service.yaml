apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: notifications
  namespace: api
spec:
  hosts:
    - "api.sogeor.com"
  gateways:
    - "istio-system/master"
  http:
    - match:
        - uri:
            prefix: /v1/notifications
          port: 9090
      route:
        - destination:
            port:
              number: 9090
            host: notifications.api.svc.cluster.local
            subset: v1
    - match:
        - uri:
            prefix: /v1/notifications
      route:
        - destination:
            port:
              number: 8080
            host: notifications.api.svc.cluster.local
            subset: v1
  exportTo:
    - "istio-system"
